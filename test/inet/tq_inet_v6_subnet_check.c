#include <libtq/inet.h>
#include <libtq/test.h>

TQ_TEST("inet/tq_inet_v6_subnet_check/basic") {
  uint8_t address[16] = { 0x00, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00,
			  0x00, 0x00, 0xFF, 0xFF,  192, 168, 10, 1 };
  uint8_t network[16] = { 0x00, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00,
			  0x00, 0x00, 0xFF, 0xFF,  192, 168, 10, 0 };
  return tq_inet_v6_subnet_check(address, network, 120);
}

TQ_TEST("inet/tq_inet_v6_subnet_check/subnet_pass") {
  uint8_t address[16] = { 0x00, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00,
			  0x00, 0x00, 0xFF, 0xFF,  192, 168, 10, 66 };
  uint8_t network[16] = { 0x00, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00,
			  0x00, 0x00, 0xFF, 0xFF,  192, 168, 10, 65 };
  return tq_inet_v6_subnet_check(address, network, 122);
}

TQ_TEST("inet/tq_inet_v6_subnet_check/subnet_fail") {
  uint8_t address[16] = { 0x00, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00,
			  0x00, 0x00, 0xFF, 0xFF,  192, 168, 10, 2 };
  uint8_t network[16] = { 0x00, 0x00, 0x00, 0x00,  0x00, 0x00, 0x00, 0x00,
			  0x00, 0x00, 0xFF, 0xFF,  192, 168, 10, 65 };
  return !tq_inet_v6_subnet_check(address, network, 122);
}
